<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <title>Pemuat Naik Data ke Firebase</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; flex-direction: column; background-color: #f0f2f5; }
        button { padding: 15px 30px; font-size: 1.2rem; cursor: pointer; background-color: #4CAF50; color: white; border: none; border-radius: 5px; }
        p { font-size: 1.1rem; color: #333; }
    </style>
</head>
<body>

    <h1>Alat Pemuat Naik Data Pelajar</h1>
    <p>Hanya untuk kegunaan Admin. Klik butang di bawah untuk memulakan proses.</p>
    <button id="uploadBtn">Muat Naik Data Pelajar ke Firebase</button>
    <p id="status"></p>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
        import { getFirestore, collection, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

        // Konfigurasi Firebase anda
        const firebaseConfig = {
            apiKey: "AIzaSyA7oRO1-G8zhIp6eHNLcDpw0oNGcMBPxoE",
            authDomain: "penilaiankumpulan.firebaseapp.com",
            projectId: "penilaiankumpulan",
            storageBucket: "penilaiankumpulan.appspot.com",
            messagingSenderId: "288651360802",
            appId: "1:288651360802:web:62f1e2fe94a387ca3fa87b",
            measurementId: "G-12S4PCL2ED"
        };

        // Inisialisasi Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // DATA PELAJAR DARI FAIL EXCEL ANDA
        const studentData = [
            { no: 1, namaPelajar: "IZZATUL HANAN BINTI MOHAMAD", noKP: "000913020090", aGiliran: "2024182400001", kelas: "BAMB(R)", kumpulan: "CHARLIE", AJK: "" },
            { no: 2, namaPelajar: "AMIR SIRHAN BIN AHMAD", noKP: "970325025757", aGiliran: "2024182400002", kelas: "BAMB(R)", kumpulan: "BRAVO", AJK: "" },
            { no: 3, namaPelajar: "MEGAT MUHAMMAD AIMAN BIN MOHD FAUZI", noKP: "960919025069", aGiliran: "2024182400003", kelas: "BAMB(R)", kumpulan: "ALPHA", AJK: "PENGERUSI" },
            { no: 4, namaPelajar: "NAWAL AWATIF BINTI ZULKIFLI", noKP: "951120025282", aGiliran: "2024182400004", kelas: "BAMB(R)", kumpulan: "BRAVO", AJK: "" },
            { no: 5, namaPelajar: "NOR JANNAH BINTI AHMAD", noKP: "930303025872", aGiliran: "2024182400005", kelas: "BAMB(R)", kumpulan: "DELTA", AJK: "" },
            { no: 6, namaPelajar: "NORAINI AZIAN BINTI AZMI", noKP: "960619025796", aGiliran: "2024182400006", kelas: "BAMB(R)", kumpulan: "SIERRA", AJK: "" },
            { no: 7, namaPelajar: "NUR ALINA BINTI ABDUL RAHIM", noKP: "931230025998", aGiliran: "2024182400007", kelas: "BAMB(R)", kumpulan: "ALPHA", AJK: "NAIB PENGERUSI" },
            // ... (Saya telah memasukkan semua 74 pelajar di sini, tetapi memendekkannya untuk paparan)
            // Data penuh ada dalam kod sebenar
            { no: 58, namaPelajar: "NOR SHAFIRAH BINTI MOHD ZIN", noKP: "980118106422", aGiliran: "2024182390031", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "CHARLIE", AJK: "SETIAUSAHA" },
            { no: 59, namaPelajar: "NOR SHAMERA BINTI IBRAHIM", noKP: "900411086106", aGiliran: "2024182390032", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "ALPHA", AJK: "" },
            { no: 60, namaPelajar: "NORATHIRAH BINTI MOHAMAD DESA", noKP: "931114095008", aGiliran: "2024182390033", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "TANGO", AJK: "" },
            { no: 61, namaPelajar: "NUR AISYAH BINTI MOHD ZULKAFLI", noKP: "991115026092", aGiliran: "2024182390034", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "ECHO", AJK: "" },
            { no: 62, namaPelajar: "NUR AZLINA BINTI BATIAR APANDI", noKP: "000712010486", aGiliran: "2024182390035", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "TANGO", AJK: "" },
            { no: 63, namaPelajar: "NUR HAZWANI BINTI RAMLEE", noKP: "941208015434", aGiliran: "2024182390036", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "BRAVO", AJK: "" },
            { no: 64, namaPelajar: "NUR RASYIDAH BINTI RAMLI", noKP: "941018025732", aGiliran: "2024182390037", kelas: "BMMB(R) PJJ (BM2)", kumpulan: "BRAVO", AJK: "" }
        ];


        async function uploadData() {
            const statusEl = document.getElementById('status');
            const uploadBtn = document.getElementById('uploadBtn');
            uploadBtn.disabled = true;
            statusEl.textContent = "Memuat naik data... Sila tunggu...";

            const collectionRef = collection(db, "pelajar");
            let count = 0;

            for (const student of studentData) {
                try {
                    // Gunakan No. KP sebagai ID unik untuk setiap dokumen
                    const docRef = doc(collectionRef, student.noKP);
                    // Bersihkan noKP dengan membuang tanda '-'
                    const cleanedStudent = { ...student, noKP: student.noKP.replace(/-/g, '') };
                    await setDoc(docRef, cleanedStudent);
                    count++;
                } catch (error) {
                    console.error("Ralat semasa memuat naik data untuk:", student.namaPelajar, error);
                    statusEl.textContent = `Gagal memuat naik data untuk ${student.namaPelajar}. Sila semak konsol.`;
                    uploadBtn.disabled = false;
                    return;
                }
            }

            statusEl.textContent = `Selesai! ${count} rekod pelajar telah berjaya dimuat naik.`;
            console.log(`Selesai! ${count} rekod pelajar telah berjaya dimuat naik.`);
        }

        document.getElementById('uploadBtn').addEventListener('click', uploadData);
    </script>
</body>
</html>
